<!doctype html><html lang="pt-BR"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>NFC Access</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:"Inter",system-ui,Arial,sans-serif}
body{height:100vh;background:#020617;color:#fff;overflow:hidden;display:flex;align-items:center;justify-content:center;text-align:center;position:relative}
canvas.bgAnim{position:fixed;inset:0;z-index:-2;background:radial-gradient(circle at 30% 30%,#0f172a,#000)}
h1{font-size:1.8rem;margin-bottom:.5rem}
p{color:#9ca3af;font-size:.95rem;margin-bottom:1.2rem}
button{background:linear-gradient(90deg,#06b6d4,#3b82f6);color:#fff;border:none;border-radius:1.5rem;padding:1.2rem 2.5rem;font-size:1rem;font-weight:700;cursor:pointer;transition:.3s;box-shadow:0 6px 25px rgba(59,130,246,.35)}
button:active{transform:scale(.96)}
#msg{margin-top:2rem;min-height:2.5rem;font-size:1.2rem;font-weight:600;opacity:0;transition:opacity .8s ease}
#msg.show{opacity:1}
.ok{color:#22c55e}
.err{color:#ef4444}

/* === CORRIGIDO: TELA WELCOME FULL ===*/
.welcome{
  position:fixed;inset:0;width:100%;height:100%;
  background:rgba(0,0,0,.7);backdrop-filter:blur(10px);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  opacity:0;transition:opacity .45s ease;z-index:9;
}
.welcome.show{opacity:1}

.icon{width:90px;height:90px;border-radius:50%;border:4px solid #22c55e;position:relative;animation:popIn .35s ease forwards}
.icon::after{content:"";position:absolute;left:22px;top:35px;width:22px;height:40px;border-right:4px solid #22c55e;border-bottom:4px solid #22c55e;transform:rotate(45deg) scale(0);transform-origin:bottom left;animation:check .45s ease .2s forwards}
.icon.err{border-color:#ef4444}
.icon.err::after{left:28px;top:25px;width:30px;height:30px;border:none;background:linear-gradient(to bottom right,transparent 45%,#ef4444 45%,#ef4444 55%,transparent 55%)}

@keyframes popIn{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}
@keyframes check{to{transform:rotate(45deg) scale(1)}}

.welcome h2{margin-top:2.5rem;font-size:1.6rem;font-weight:700}

.menuBtn{position:fixed;top:20px;left:20px;width:36px;height:28px;cursor:pointer;z-index:20}
.menuBtn span{display:block;height:4px;background:#fff;border-radius:2px;margin:6px 0;transition:.4s}
.menuBtn.active span:nth-child(1){transform:translateY(10px) rotate(45deg)}
.menuBtn.active span:nth-child(2){opacity:0}
.menuBtn.active span:nth-child(3){transform:translateY(-10px) rotate(-45deg)}
.menu{position:fixed;top:0;left:-260px;width:260px;height:100%;background:rgba(0,0,0,.8);backdrop-filter:blur(12px);transition:.4s;padding:80px 30px;z-index:15;display:flex;flex-direction:column;gap:20px}
.menu.show{left:0}
.menu button{width:100%;border-radius:.8rem;padding:1rem;font-size:1rem;font-weight:600;text-align:left;background:rgba(255,255,255,.05);color:#fff;box-shadow:none}
.menu button:hover{background:rgba(255,255,255,.15)}
.menu button.danger{color:#ef4444;border:1px solid #ef4444;background:transparent}
.tapIcon{width:70px;height:70px;margin:20px auto 0;position:relative}
.tapIcon::before,.tapIcon::after{content:"";position:absolute;border:2px solid #38bdf8;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);animation:tapAnim 2.5s infinite ease-in-out}
.tapIcon::before{width:30px;height:30px;opacity:.8}
.tapIcon::after{width:50px;height:50px;animation-delay:1.2s;opacity:.4}
@keyframes tapAnim{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.3)}}
audio{display:none}

.splash{position:fixed;inset:0;background:linear-gradient(180deg,#1e3a8a,#1e40af,#0f172a);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:10}
.splash h1{font-size:2rem;margin-bottom:1rem}
.splash button{margin-top:2rem;padding:1.2rem 2.8rem;font-size:1.1rem;border-radius:2rem}
</style>
<body>
<canvas class="bgAnim"></canvas>

<div class="menuBtn" id="menuBtn"><span></span><span></span><span></span></div>
<div class="menu" id="menu">
  <button id="viewBtn">Ver / Editar Cadastros</button>
  <button id="clearBtn" class="danger">Excluir Tudo</button>
</div>

<div class="splash" id="splash">
  <h1>üîê NFC Access</h1>
  <p>Precisamos da sua permiss√£o para acessar o sensor NFC</p>
  <button id="allowBtn">Iniciar e Permitir Leitura NFC</button>
</div>

<main style="opacity:0;transition:opacity .6s ease;">
  <h1>NFC Access</h1>
  <p id="info">Aproxime seu cart√£o NFC</p>
  <div class="tapIcon"></div>
  <div id="msg"></div>
</main>

<div class="welcome" id="welcome"><div class="icon"></div><h2 id="welcomeText">Bem-vindo!</h2></div>
<audio id="beep" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

<script>
(()=>{const $=id=>document.getElementById(id),LS='nfc_users_v1';let reader,msgTimer;
function db(){try{return JSON.parse(localStorage.getItem(LS)||'{}')}catch{return{}}}
function save(d){localStorage.setItem(LS,JSON.stringify(d))}
function showMsg(t,c=''){const e=$('msg');clearTimeout(msgTimer);e.className='show '+c;e.textContent=t;msgTimer=setTimeout(()=>{e.classList.remove('show')},3000)}
function playSound(){const a=$('beep');a.currentTime=0;a.play().catch(()=>{})}
function vibrate(ms){if('vibrate'in navigator)navigator.vibrate(ms)}
function showWelcome(t,err=false){
  const w=$('welcome'),i=w.querySelector('.icon'),tx=$('welcomeText');
  w.classList.remove('show'); void w.offsetWidth;
  i.className=err?'icon err':'icon'; tx.textContent=t; tx.style.color=err?'#ef4444':'#22c55e';
  w.classList.add('show');
  setTimeout(()=>{w.classList.remove('show')},1800)
}
async function startNFC(){
 if(!('NDEFReader'in window)){showMsg('NFC n√£o suportado','err');return;}
 try{
  reader=new NDEFReader();await reader.scan();showMsg('Aguardando cart√£o...');
  reader.onreading=async e=>{
    const id=e.serialNumber||Math.random().toString(36).slice(2,8);
    const users=db();
    if(users[id]){showMsg('Bem-vindo, '+users[id]+'!','ok');playSound();showWelcome('Bem-vindo '+users[id]+'!')}
    else{
      vibrate(250);showWelcome('Acesso Negado',true);
      setTimeout(async()=>{
        if(confirm('Cart√£o n√£o encontrado. Deseja cadastrar?')){
          const nome=prompt('Digite seu nome para cadastro:');
          if(nome){users[id]=nome;save(users);showMsg(nome+' cadastrado!','ok');showWelcome('Cadastrado!',false);}
        }
      },3000);
    }
  };
 }catch(e){showMsg('Erro ou permiss√£o negada','err');}
}
$('allowBtn').onclick=async()=>{await startNFC();$('splash').remove();document.querySelector('main').style.opacity=1;}
$('menuBtn').onclick=()=>{$('menuBtn').classList.toggle('active');$('menu').classList.toggle('show')}
$('viewBtn').onclick=()=>{const users=db();alert(Object.keys(users).length?Object.entries(users).map(([k,v])=>`${v} (${k})`).join('\n'):'Nenhum cadastro.')};
$('clearBtn').onclick=()=>{if(confirm('Tem certeza que deseja excluir todos os cadastros?')){localStorage.removeItem(LS);showMsg('Todos os cadastros exclu√≠dos','err')}};

// anima√ß√£o fundo
const c=document.querySelector('.bgAnim'),x=c.getContext('2d');let w,h,particles=[];
function resize(){w=innerWidth;h=innerHeight;c.width=w;c.height=h}
window.addEventListener('resize',resize);resize();
class Particle{constructor(x,y,r){this.x=x;this.y=y;this.r=r;this.baseY=y;}
update(t){this.y=this.baseY+Math.sin(t/500+this.x/50)*8}
draw(){x.beginPath();x.arc(this.x,this.y,this.r,0,2*Math.PI);x.fillStyle='rgba(56,189,248,.25)';x.fill()}}
for(let i=0;i<250;i++)particles.push(new Particle(Math.random()*w,Math.random()*h,Math.random()*2+1));
function animate(t){x.clearRect(0,0,w,h);for(let p of particles)p.update(t),p.draw();requestAnimationFrame(animate)}
animate();
})();
</script>
</body>
</html>


